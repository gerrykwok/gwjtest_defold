require("main.common.MiscUtil")
local GwjUIListView = require("gwjui.GwjUIListView")
local GwjUIPushButton = require("gwjui.GwjUIPushButton")
local GwjScaleButton = require("gwjui.GwjScaleButton")
local gwjinput = require("gwjui.gwjinput")
local TipsBanner = require("main.common.tipsbanner.tipsbanner")

function init(self)
	msg.post(".", "acquire_input_focus")
	self.m_input = gwjinput.createInstance()
	--郭伟基测试listview
	local maxItemType = 5
	--list1 ---------------------------------------------------------------------
	local listview = GwjUIListView.createInstance({
		list_id = "list1",
		direction = GwjUIListView.DIRECTION_VERTICAL,
	})
	listview:onTouch(function(event)
		if(event.name == "clicked") then
			ccprint("clicked:%d", event.itemPos)
			local str = string.format("clicked1:%d", event.itemPos)
			TipsBanner.show(str)
		else
--			dump(event, "listview touch")
		end
	end)
	for i=1,5 do
		local item = listview:addItem(string.format("list_item%d", math.modf((i-1)%maxItemType)+1))
	end
	listview:reload()
	--list2 ---------------------------------------------------------------------
	local listview = GwjUIListView.createInstance({
		list_id = "list2",
		direction = GwjUIListView.DIRECTION_VERTICAL,
	})
--	listview:setBounceable(false)
	listview:onTouch(function(event)
		if(event.name == "clicked") then
			ccprint("clicked:%d", event.itemPos)
			local str = string.format("clicked2:%d", event.itemPos)
			TipsBanner.show(str)
		else
--			dump(event, "listview touch")
		end
	end)
	for i=1,20 do
		local idx = math.modf((i-1)%maxItemType)+1
		local itemId = string.format("list_item%d", idx)
		local wh = gui.get_size(gui.get_node(itemId))
		local item = listview:addItem(itemId, wh.x, wh.y+20, function(clones)
--			dump(clones, "clones")
			local text = clones[string.format("idx%d", idx)]
			if(text) then
				gui.set_text(text, string.format("%d:", i))
			end
		end)
	end
	listview:reload()
	--list3 ---------------------------------------------------------------------
	local list3 = GwjUIListView.createInstance({
		list_id = "list3",
		direction = GwjUIListView.DIRECTION_HORIZONTAL,
	})
	list3:onTouch(function(event)
		if(event.name == "clicked") then
			ccprint("clicked:%d", event.itemPos)
			local str = string.format("clicked3:%d", event.itemPos)
			TipsBanner.show(str)
		else
--			dump(event, "listview touch")
		end
	end)
	for i=1,20 do
		local item = list3:addItem(string.format("list_item%d", math.modf((i-1)%maxItemType)+1))
--		item.width = item.width + 10
	end
	list3:reload()
	--button1 -----------------------------------------------------------------------
	local btn = GwjUIPushButton.createInstance({
		main_id = "button1",
	})
	btn:onButtonPressed(function()
		ccprint("button1 pressed")
	end)
	:onButtonReleased(function()
		ccprint("button1 released")
	end)
	:onButtonClicked(function()
		TipsBanner.show("button1 clicked")
	end)
	--button2 -----------------------------------------------------------------------
	local btn = GwjScaleButton.createInstance({
		main_id = "button2",
	})
	btn:onButtonPressed(function()
		ccprint("button2 pressed")
	end)
	:onButtonReleased(function()
		ccprint("button2 released")
	end)
	:onButtonClicked(function()
		TipsBanner.show("button2 clicked")
	end)
end

function final(self)
	self.m_input:final()
end

function update(self, dt)
end

function on_message(self, message_id, message, sender)
end

function on_input(self, action_id, action)
	if(action_id == hash("touch")) then
		self.m_input:handleTouchEvent(action)
	end
end

function on_reload(self)
end
